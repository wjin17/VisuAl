let canvas;
let canvasWidth;
let sort = false;

let values = Array.from({ length: 40 }, () => Math.floor(Math.random() * 40)); //[30, 25, 27, 12, 15, 5, 8, 4, 1, 3, 7, 20];
//let values = []; //= [30, 29, 28, 27, 26, 24, 23, 22, 21];
let i = 0;
let j = 0;

function setup() {
  canvasWidth = windowWidth * 0.9;
  canvas = createCanvas(canvasWidth, 250);
  canvas.parent("canvas__inner");
  background("#525252");
  //frameRate(2);
}

function draw() {
  background("#525252");

  const rectWidth = canvasWidth / values.length;
  console.log("canvas width", canvasWidth);
  if (sort) {
    for (let j = 0; j < values.length - i; j++) {
      let a = values[j];
      let b = values[j + 1];
      if (a > b) {
        swap(values, j, j + 1);
      }
    }
    sort = i < values.length;
  } else {
    console.log("finished");
    i = 0;
    noLoop();
  }
  i++;
  for (let i = 0; i < values.length; i++) {
    const rectHeight = (values[i] / Math.max(...values)) * height * 0.75;
    stroke(0);
    fill(255);
    //line(i, height, i, height - values[i]);
    // rect(x, y, w, h)
    rect(i * rectWidth, height - (rectHeight + 30), rectWidth, rectHeight);
    textAlign(CENTER, CENTER);
    text(values[i], i * rectWidth + Math.floor(rectWidth / 2), height - 10);
  }
}

function windowResized() {
  canvas.size(windowWidth * 0.9, 250);
  canvasWidth = windowWidth * 0.9;
  loop();
}

function swap(arr, a, b) {
  let temp = arr[a];
  arr[a] = arr[b];
  arr[b] = temp;
}

function bubbleSort() {
  var userValues = document
    .getElementById("bubble-sort__data")
    .value.split(",")
    .map(Number);
  console.log(userValues);
  if (userValues[0]) {
    values = userValues;
  }
  console.log(userValues);
  console.log("fuck");
  sort = true;
  loop();
}
